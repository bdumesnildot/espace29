---
import Icon from "@components/ui/icons/Icon.astro"
import { navigationItems } from "@lib/navigation-helper.ts"

const currentPath = Astro.url.pathname

const isActiveLink = (href: string) => {
  if (href === "/") return currentPath === "/"
  return currentPath.startsWith(href)
}

const getLinkStyle = (href: string) => {
  const baseStyle =
    "font-eina03 hover:text-gray-600 transition-colors duration-200 focus:outline-none px-4 py-3 block"

  if (isActiveLink(href)) {
    return `${baseStyle} text-gray-900 font-medium underline`
  }

  return `${baseStyle} text-gray-700`
}
---

<nav class="relative mt-1.5 h-[54px] border-y-[1.5px] bg-gray-50">
  <div class="flex h-full items-center justify-between px-6">
    <a href="/" class="font-eina03 text-2xl font-medium text-gray-900">
      Espace29
    </a>

    <button
      id="mobile-menu-button"
      class="p-2 text-gray-700 hover:text-gray-900 focus:outline-none"
      aria-label="Toggle menu"
    >
      <Icon name="burger-menu" class="h-6 w-6" />
    </button>
  </div>

  <div
    id="mobile-menu"
    class="absolute top-full right-0 left-0 z-50 hidden border-y-[1.5px] border-gray-200 bg-white shadow-lg"
  >
    <ul class="flex flex-col text-xl">
      {
        navigationItems.slice(1).map(({ href, label }) => (
          <li>
            <a href={href} class={getLinkStyle(href)}>
              {label}
            </a>
          </li>
        ))
      }
    </ul>
  </div>
</nav>

<script>
  const menuButton = document.getElementById("mobile-menu-button")
  const mobileMenu = document.getElementById("mobile-menu")

  if (menuButton && mobileMenu) {
    menuButton.addEventListener("click", () => {
      mobileMenu.classList.toggle("hidden")
    })

    document.addEventListener("click", (event) => {
      if (
        !menuButton.contains(event.target as Node) &&
        !mobileMenu.contains(event.target as Node)
      ) {
        mobileMenu.classList.add("hidden")
      }
    })
  }
</script>
